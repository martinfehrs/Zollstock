target_sources(tests PRIVATE unit_tests/prefixes.cpp)
target_sources(tests PRIVATE unit_tests/constants/length.cpp)
target_sources(tests PRIVATE unit_tests/literals/length.cpp)
target_sources(tests PRIVATE unit_tests/constants/time.cpp)
target_sources(tests PRIVATE unit_tests/literals/time.cpp)
target_sources(tests PRIVATE unit_tests/constants/mass.cpp)
target_sources(tests PRIVATE unit_tests/literals/mass.cpp)
target_sources(tests PRIVATE unit_tests/constants/area.cpp)
target_sources(tests PRIVATE unit_tests/literals/area.cpp)
target_sources(tests PRIVATE unit_tests/constants/volume.cpp)
target_sources(tests PRIVATE unit_tests/literals/volume.cpp)
target_sources(tests PRIVATE unit_tests/constants/planar_angle.cpp)
target_sources(tests PRIVATE unit_tests/literals/planar_angle.cpp)
target_sources(tests PRIVATE unit_tests/constants/temperature.cpp)
target_sources(tests PRIVATE unit_tests/literals/temperature.cpp)
target_sources(tests PRIVATE unit_tests/constants/electric_current.cpp)
target_sources(tests PRIVATE unit_tests/literals/electric_current.cpp)
target_sources(tests PRIVATE unit_tests/constants/luminous_intensity.cpp)
target_sources(tests PRIVATE unit_tests/literals/luminous_intensity.cpp)
target_sources(tests PRIVATE unit_tests/constants/one.cpp)
target_sources(tests PRIVATE unit_tests/literals/one.cpp)
target_sources(tests PRIVATE unit_tests/constants/squared_time.cpp)
target_sources(tests PRIVATE unit_tests/constants/velocity.cpp)
target_sources(tests PRIVATE unit_tests/constants/acceleration.cpp)
target_sources(tests PRIVATE unit_tests/constants/angular_velocity.cpp)
target_sources(tests PRIVATE quantity_tests/construction.cpp)
target_sources(tests PRIVATE quantity_tests/quantity.cpp)
target_sources(tests PRIVATE quantity_tests/math.cpp)
target_sources(tests PRIVATE quantity_tests/limits.cpp)
target_sources(tests PRIVATE structure_tests.cpp)

file(GLOB_RECURSE headers RELATIVE "${CMAKE_SOURCE_DIR}/include" "${CMAKE_SOURCE_DIR}/include/zollstock/*.hpp")

foreach(header ${headers})
    cmake_path(GET header PARENT_PATH parent_path)
    cmake_path(GET header STEM stem)
    set(self_containment_test_dir "${CMAKE_CURRENT_BINARY_DIR}/self_containment/${parent_path}")
    set(self_containment_test_src "${self_containment_test_dir}/${stem}_self_containment_test.cpp")
    file(MAKE_DIRECTORY "${CMAKE_CURRENT_BINARY_DIR}/self_containment/${parent_path}")
    set(TEST_INCLUDE_PATH "${header}")
    configure_file("header_self_containment_test.cpp.in" "${self_containment_test_src}")
    target_sources(tests PRIVATE "${self_containment_test_src}")
endforeach()

if (MSVC)
    target_link_options   (tests PRIVATE "/stack:10000000")
    target_compile_options(tests PRIVATE "/bigobj"        )
endif(MSVC)
